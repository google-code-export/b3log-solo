<div id="top">
    <a href="index.do" class="logo">
        <span style="color: orange;">B</span>
        <span style="color: blue;">3</span>
        <span style="color: green;">L</span>
        <span style="color: red;">O</span>
        <span style="color: blue;">G</span>
    </a>
    <span class="right">
        <span>language</span> |
        <a id="loginStatus" href="#"></a>
    </span>
    <div class="clear"></div>
    <div id="loginPanel" class="none">
        <table class="form" width="99%" cellspacing="9px" cellpadding="0">
            <tbody>
                <tr>
                    <th width="80px">
                        password:
                    </th>
                    <td>
                        <input id="password" type="password"/>
                    </td>
                </tr>
                <tr>
                    <td>
                        <span id="error" class="errorMsg"></span>
                    </td>
                    <th>
                        <button onclick="login();">submit</button>
                    </th>
                </tr>
            </tbody>
        </table>
    </div>
</div>
<script type="text/javascript">
    var loginDialog = undefined,
    loginStatus = ${loginStatus};

    var logout = function () {
        jsonRpc.userService.logout(function (result, error) {
            switch (result.sc) {
                case "USER_LOGOUT_SUCC":
                    getStatus(0);
                    break;
                default:
                    break;
            }
        });
    }

    var popLogin = function () {
        loginDialog = $("#loginPanel").dialog();
        $("#password").focus().keypress(function (event) {
            if (event.keyCode === 13) {
                login();
            }
        });
    }

    var getStatus = function (loginStatus) {
        $("#loginStatus").unbind("click");
        if (loginStatus === 0) {
            $("#loginStatus").bind("click", popLogin).text("login");
        } else {
            $("#loginStatus").bind("click", logout).text("logout");
        }
    }
    getStatus(loginStatus);

    var login = function () {
        var requestJSONObject = {
            "userPassword": $("#password").val()
        };
        jsonRpc.userService.login(function (result, error) {
            switch (result.sc) {
                case "USER_LOGIN_SUCC":
                    loginDialog.dialog("close");
                    getStatus(1);
                    break;
                case "USER_LOGIN_FAIL_":
                    $("#error").text("login fail!");
                    break;
                default:
                    break;
            }
        }, requestJSONObject);
    }
</script>