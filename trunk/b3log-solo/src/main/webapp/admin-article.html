<table class="form" width="99%" cellpadding="0px" cellspacing="9px">
    <tbody>
        <tr>
            <th>
                ${title1Label}
            </th>
            <td>
                <input id="title" type="text"/>
            </td>
        </tr>
        <tr>
            <th>
                ${content1Label}
            </th>
            <td>&nbsp;</td>
        </tr>
        <tr>
            <td colspan="2">
                <textarea cols="80" rows="12" id="articleContent" name="articleContent"></textarea>
            </td>
        </tr>
        <tr>
            <th>tagsï¼š</th>
            <td>
                <input id="tag" type="text"/>
            </td>
        </tr>
        <tr>
            <th valign="top">${abstract1Label}</th>
            <td>
                <textarea id="abstract" rows="3" cols="80"></textarea>
            </td>
        </tr>
        <tr>
            <th colspan="2">
                <button id="submitArticle">${postLabel}</button>
            </th>
        </tr>
    </tbody>
</table>
<script type="text/javascript">
    var content = tinyMCE.init({
        // General options
        mode : "exact",
        elements : "articleContent",
        theme : "advanced",
        plugins : "pagebreak,style,layer,table,save,advhr,advimage,advlink,emotions,iespell,insertdatetime,preview,media,searchreplace,print,contextmenu,paste,directionality,fullscreen,noneditable,visualchars,nonbreaking,xhtmlxtras,template,inlinepopups,autosave",

        // Theme options
        theme_advanced_buttons1 : "save,newdocument,|,bold,italic,underline,strikethrough,|,justifyleft,justifycenter,justifyright,justifyfull,styleselect,formatselect,fontselect,fontsizeselect",
        theme_advanced_buttons2 : "cut,copy,paste,pastetext,pasteword,|,search,replace,|,bullist,numlist,|,outdent,indent,blockquote,|,undo,redo,|,link,unlink,anchor,image,cleanup,help,code,|,insertdate,inserttime,preview,|,forecolor,backcolor",
        theme_advanced_buttons3 : "tablecontrols,|,hr,removeformat,visualaid,|,sub,sup,|,charmap,emotions,iespell,media,advhr,|,print,|,ltr,rtl,|,fullscreen",
        theme_advanced_buttons4 : "insertlayer,moveforward,movebackward,absolute,|,styleprops,|,cite,abbr,acronym,del,ins,attribs,|,visualchars,nonbreaking,template,pagebreak,restoredraft",
        theme_advanced_toolbar_location : "top",
        theme_advanced_toolbar_align : "left",
        theme_advanced_statusbar_location : "bottom",
        theme_advanced_resizing : true,

        // Replace values for the template plugin
        template_replace_values : {
            username : "Some User",
            staffid : "991234"
        },
        extended_valid_elements: "pre[name|class]"
    });

    
    var addArticle = function () {
        var requestJSONObject = {
            "article": {
                "articleTitle": $("#title").val(),
                "articleContent": tinyMCE.get('articleContent').getContent(),
                "articleAbstract": $("#abstract").val(),
                "articleTags": $("#tag").val()
            }
        };
        var result = jsonRpc.articleService.addArticle(requestJSONObject);
        switch (result.sc) {
            case "ADD_ARTICLE_SUCC":
                setCurrentNaviStyle(1);
                $("#content").load("admin-article-list.do", function () {
                    //KE.remove("articleContent");
                });
                $("#tipMsg").text("${addSuccLabel}");
                break;
            default:
                break;
        }
    }

    var updateArticle = function () {
        var requestJSONObject = {
            "article": {
                "oId": $("#title").data("oId"),
                "articleTitle": $("#title").val(),
                "articleContent": tinyMCE.get('articleContent').getContent(),
                "articleAbstract": $("#abstract").val(),
                "articleTags": $("#tag").val()
            }
        };
        var result = jsonRpc.articleService.updateArticle(requestJSONObject);
        switch (result.sc) {
            case "UPDATE_ARTICLE_SUCC":
                setCurrentNaviStyle(1);
                $("#content").load("admin-article-list.do", function () {
                    //KE.remove("articleContent");
                });
                $("#tipMsg").text("${updateSuccLabel}");
                break;
            default:
                break;
        }
    }

    $("#submitArticle").click(function () {
        if ($("#title").data("oId")) {
            updateArticle();
        } else {
            addArticle();
        }
    });
</script>
