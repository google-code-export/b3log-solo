<table class="form" width="99%" cellpadding="0px" cellspacing="9px">
    <tbody>
        <tr>
            <th>
                标题：
            </th>
            <td>
                <input id="title" type="text"/>
            </td>
        </tr>
        <tr>
            <th>
                正文：
            </th>
            <td>&nbsp;</td>
        </tr>
        <tr>
            <td colspan="2">
                <textarea cols="80" rows="12" id="articleContent"></textarea>
            </td>
        </tr>
        <tr>
            <th>tags：</th>
            <td>
                <input id="tag" type="text"/>
            </td>
        </tr>
        <tr>
            <th valign="top">摘要：</th>
            <td>
                <textarea id="abstract" rows="5" cols="80"></textarea>
            </td>
        </tr>
        <tr>
            <th colspan="2">
                <button id="submitArticle">提交</button>
            </th>
        </tr>
    </tbody>
</table>
<script type="text/javascript">
    KE.init({
        id : "articleContent",
        items : ['fontname', 'fontsize', '|', 'textcolor', 'bgcolor', 'bold', 'italic', 'underline',
            'removeformat', '|', 'justifyleft', 'justifycenter', 'justifyright', 'insertorderedlist',
            'insertunorderedlist', '|', 'emoticons', 'image', 'link']
    });

    KE.create("articleContent");

    var addArticle = function () {
        var requestJSONObject = {
            "article": {
                "articleTitle": $("#title").val(),
                "articleContent": KE.html("articleContent"),
                "articleAbstract": $("#abstract").val(),
                "articleTags": $("#tag").val()
            }
        };
        jsonRpc.articleService.addArticle(function (result, error) {
            switch (result.sc) {
                case "ADD_ARTICLE_SUCC":
                    alert("添加成功！");
                    $("#content").load("admin-article-list.do");
                    break;
                default:
                    break;
            }
        }, requestJSONObject);
    }

    var updateArticle = function () {
        var requestJSONObject = {
            "article": {
                "oId": $("#title").data("oId"),
                "articleTitle": $("#title").val(),
                "articleContent": KE.html("articleContent"),
                "articleAbstract": $("#abstract").val(),
                "articleTags": $("#tag").val()
            }
        };
        jsonRpc.articleService.updateArticle(function (result, error) {
            switch (result.sc) {
                case "UPDATE_ARTICLE_SUCC":
                    alert("更新成功！");
                    $("#content").load("admin-article-list.do");
                    break;
                default:
                    break;
            }
        }, requestJSONObject);
    }

    $("#submitArticle").click(function () {
        if ($("#title").data("oId")) {
            updateArticle();
        } else {
            addArticle();
        }
    });
</script>
